@using System.Globalization
@model RequestListingViewModel
@{
    Layout = "_Layout";
    ViewData.SetActivePage(PluginNavPages.Settings, "Plugin Listing Request");
}

<div class="d-flex align-items-center justify-content-between mb-4">
    <h2 class="mb-0">
        @ViewData["Title"]
    </h2>
	@if (!Model.PendingListing)
	{
		<div class="d-flex gap-3 mt-3 mt-sm-0">
			<button type="submit" form="request-listing-form" class="btn btn-success" @(Model.ValidationRequirementMet ? "" : "disabled")>Submit</button>
		</div>
	}
	@if (Model.PendingListing && Model.CanSendEmailReminder)
	{
		<form asp-controller="Plugin" asp-action="SendReminder" asp-route-pluginSlug="@Model.PluginSlug" method="post" class="d-inline">
			<button type="submit" class="btn btn-success">Send Reminder</button>
		</form>
	}
</div>

@if (!Model.ValidationRequirementMet)
{
	<div class="alert alert-warning alert-dismissible mb-4" role="alert">
		<button type="button" class="btn-close" data-bs-dismiss="alert">
			<vc:icon symbol="close" />
		</button>
		<h5 class="alert-heading" text-translate="true">Important notice about listing this plugin</h5>
		<p class="mb-0">
			<span text-translate="true">To get this plugin listed with other public BTCPay Server plugins, please ensure you have the following addressed</span>
			<a href="#warning-details" data-bs-toggle="collapse" class="alert-link" text-translate="true">Read more</a>
		</p>
		<div class="collapse" id="warning-details">
			<p class="my-3">
				<strong>Verified social accounts:</strong> All plugin ownersâ€™ GitHub accounts are linked and verified. To complete the process
				<span>
					<a asp-controller="Account" asp-action="AccountDetails" class="text-dark text-decoration-underline">click here</a>
				</span>
			</p>
			<p class="mb-3">
				<strong>Plugin Settings:</strong> Plugin logo and documentation url must be set. <span>
					<a asp-controller="Plugin" asp-action="Settings" asp-route-pluginSlug="@Model.PluginSlug" class="text-dark text-decoration-underline">Go to plugin settings to complete</a>
				</span>
			</p>
		</div>
	</div>
}

<div class="row">
    <div class="col-xl-8 col-xxl-constrain">
		<form id="request-listing-form" asp-action="RequestListing" enctype="multipart/form-data">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>

            <div class="form-group">
				<label asp-for="ReleaseNote" class="form-label" data-required>Release Note <span class="text-muted">(max 200 characters)</span></label>
				<textarea asp-for="ReleaseNote" rows="2" maxlength="200" class="form-control" required></textarea>
				<span asp-validation-for="ReleaseNote" class="text-danger"></span>
				<span class="text-muted">This will appear in BTCPay Server's social post. Refine it as an elevator pitch.</span>
            </div>

			<div class="form-group">
				<label asp-for="TelegramVerificationMessage" class="form-label" data-required></label>
				<input asp-for="TelegramVerificationMessage" class="form-control" placeholder="https://t.me/btcpayserver/91489"  required />
				<span asp-validation-for="TelegramVerificationMessage" class="text-danger"></span>
			</div>

			<div class="form-group">
				<label asp-for="UserReviews" class="form-label" data-required></label>
				<textarea asp-for="UserReviews" class="form-control" rows="4" placeholder="https://primal.net/e/nevent1qqsqkw7c5qmlue0qvyz784ywrpkvnz2v33js4ajkj2dj0xdjdn6n2qqem7auc" required></textarea>
				<span asp-validation-for="UserReviews" class="text-danger"></span>
				<span class="text-muted">Require at least one publicly posted review ( Nostr, X, or user websites) from a reputable Bitcoiner who tested the plugin</span>
			</div>

			<div class="mb-3">
				<label asp-for="AnnouncementDate" class="form-label">
					Announcement Date & Time (optional)
				</label>
				<input asp-for="AnnouncementDate"
					   type="datetime-local"
					   class="form-control" />
				<span asp-validation-for="AnnouncementDate" class="text-danger"></span>
				<div class="text-muted">
					You may specify when this announcement should go live (include date, time)<br />
					<strong>Note:</strong> It should ideally be scheduled at least 3 days in advance
				</div>
			</div>
        </form>
    </div>
</div>
